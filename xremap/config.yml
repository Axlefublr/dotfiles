virtual_modifiers:
  - CapsLock
default_mode: default
modmap:
  - remap:
      Tab: Esc
      Esc: F13
      Compose: Super_R # For me, Compose is the Menu key

  - name: Game side mouse buttons fix
    remap:
      Btn_Side: k
      Btn_Extra: j
    application:
      only: /Terraria/

keymap:
  - name: Vim mode
    remap:
      CapsLock-Semicolon: { set_mode: default }

      q: { launch: [xdotool, mousemove, '128',  '120']}
      w: { launch: [xdotool, mousemove, '544',  '120']}
      e: { launch: [xdotool, mousemove, '960',  '120']}
      r: { launch: [xdotool, mousemove, '1376', '120']}
      t: { launch: [xdotool, mousemove, '1792', '120']}

      a: { launch: [xdotool, mousemove, '128',  '540']}
      s: { launch: [xdotool, mousemove, '544',  '540']}
      d: { launch: [xdotool, mousemove, '960',  '540']}
      f: { launch: [xdotool, mousemove, '1376', '540']}
      g: { launch: [xdotool, mousemove, '1792', '540']}

      z: { launch: [xdotool, mousemove, '128',  '960']}
      x: { launch: [xdotool, mousemove, '544',  '960']}
      c: { launch: [xdotool, mousemove, '960',  '960']}
      v: { launch: [xdotool, mousemove, '1376', '960']}
      b: { launch: [xdotool, mousemove, '1792', '960']}

      Shift-q: { launch: [xdotool, mousemove, '336',  '120']}
      Shift-w: { launch: [xdotool, mousemove, '752',  '120']}
      Shift-e: { launch: [xdotool, mousemove, '1168', '120']}
      Shift-r: { launch: [xdotool, mousemove, '1584', '120']}

      Shift-a: { launch: [xdotool, mousemove, '336',  '540']}
      Shift-s: { launch: [xdotool, mousemove, '752',  '540']}
      Shift-d: { launch: [xdotool, mousemove, '1168', '540']}
      Shift-f: { launch: [xdotool, mousemove, '1584', '540']}

      Shift-z: { launch: [xdotool, mousemove, '336',  '960']}
      Shift-x: { launch: [xdotool, mousemove, '752',  '960']}
      Shift-c: { launch: [xdotool, mousemove, '1168', '960']}
      Shift-v: { launch: [xdotool, mousemove, '1584', '960']}

      CapsLock-q: { launch: [xdotool, mousemove, '128',  '330']}
      CapsLock-w: { launch: [xdotool, mousemove, '544',  '330']}
      CapsLock-e: { launch: [xdotool, mousemove, '960',  '330']}
      CapsLock-r: { launch: [xdotool, mousemove, '1376', '330']}
      CapsLock-t: { launch: [xdotool, mousemove, '1792', '330']}

      CapsLock-a: { launch: [xdotool, mousemove, '128',  '750']}
      CapsLock-s: { launch: [xdotool, mousemove, '544',  '750']}
      CapsLock-d: { launch: [xdotool, mousemove, '960',  '750']}
      CapsLock-f: { launch: [xdotool, mousemove, '1376', '750']}
      CapsLock-g: { launch: [xdotool, mousemove, '1792', '750']}

      Shift-CapsLock-q: { launch: [xdotool, mousemove, '336',  '330']}
      Shift-CapsLock-w: { launch: [xdotool, mousemove, '752',  '330']}
      Shift-CapsLock-e: { launch: [xdotool, mousemove, '1168', '330']}
      Shift-CapsLock-r: { launch: [xdotool, mousemove, '1584', '330']}

      Shift-CapsLock-a: { launch: [xdotool, mousemove, '336',  '750']}
      Shift-CapsLock-s: { launch: [xdotool, mousemove, '752',  '750']}
      Shift-CapsLock-d: { launch: [xdotool, mousemove, '1168', '750']}
      Shift-CapsLock-f: { launch: [xdotool, mousemove, '1584', '750']}

      h: { launch: [ydotool, mousemove, '--', '-26', '0']}
      l: { launch: [ydotool, mousemove, '--', '26', '0']}
      j: { launch: [ydotool, mousemove, '--', '0', '26']}
      k: { launch: [ydotool, mousemove, '--', '0', '-26']}

      Shift-h: { launch: [ydotool, mousemove, '--', '-52', '0']}
      Shift-l: { launch: [ydotool, mousemove, '--', '52', '0']}
      Shift-j: { launch: [ydotool, mousemove, '--', '0', '52']}
      Shift-k: { launch: [ydotool, mousemove, '--', '0', '-52']}

      Alt-h: { launch: [ydotool, mousemove, '--', '-13', '0']}
      Alt-l: { launch: [ydotool, mousemove, '--', '13', '0']}
      Alt-j: { launch: [ydotool, mousemove, '--', '0', '13']}
      Alt-k: { launch: [ydotool, mousemove, '--', '0', '-13']}

      Ctrl-h: { launch: [ydotool, mousemove, '--', '-6.5', '0']}
      Ctrl-l: { launch: [ydotool, mousemove, '--', '6.5', '0']}
      Ctrl-j: { launch: [ydotool, mousemove, '--', '0', '6.5']}
      Ctrl-k: { launch: [ydotool, mousemove, '--', '0', '-6.5']}

      u: { launch: ["ydotool", "click", "c0"] } # c0 — left click
      i: { launch: ["ydotool", "click", "c2"] } # c2 — middle click
      o: { launch: ["ydotool", "click", "c1"] } # c1 — right click

      # CapsLock-u: { launch: ["xdotool", "mousedown", "1"] }
      # CapsLock-i: { launch: ["xdotool", "mousedown", "2"] }
      # CapsLock-o: { launch: ["xdotool", "mousedown", "3"] }
      # CapsLock-7: { launch: ["xdotool", "mouseup", "1"] }
      # CapsLock-8: { launch: ["xdotool", "mouseup", "2"] }
      # CapsLock-9: { launch: ["xdotool", "mouseup", "3"] }

      CapsLock-u: { launch: ["ydotool", "click", "40"] }
      CapsLock-i: { launch: ["ydotool", "click", "42"] }
      CapsLock-o: { launch: ["ydotool", "click", "41"] }
      CapsLock-7: { launch: ["ydotool", "click", "80"] }
      CapsLock-8: { launch: ["ydotool", "click", "82"] }
      CapsLock-9: { launch: ["ydotool", "click", "81"] }

      # Holds down and up a modifier (the one aside from capslock):
      # j — down event
      # k — up event
      CapsLock-Super-j: { launch: [ydotool, key, '125:1'] }
      CapsLock-Super-k: { launch: [ydotool, key, '125:0'] }
      CapsLock-Shift-j: { launch: [ydotool, key, '42:1'] }
      CapsLock-Shift-k: { launch: [ydotool, key, '42:0'] }
      CapsLock-Alt-j:   { launch: [ydotool, key, '56:1'] }
      CapsLock-Alt-k:   { launch: [ydotool, key, '56:0'] }
      CapsLock-Ctrl-j:  { launch: [ydotool, key, '29:1'] }
      CapsLock-Ctrl-k:  { launch: [ydotool, key, '29:0'] }

      m: { launch: ["ydotool", "mousemove", "-w", "--", "-1", "0"] } # left
      Comma: { launch: ["ydotool", "mousemove", "-w", "--", "0", "1"] } # up
      Dot: { launch: ["ydotool", "mousemove", "-w", "--", "0", "-1"] } # down
      Slash: { launch: ["ydotool", "mousemove", "-w", "--", "1", "0"] } # up

    mode: vim

  - name: Default mode
    remap:
      CapsLock-Semicolon: { set_mode: vim }
    mode: default

  # - name: Anki
  #   remap:
  #   application:
  #     only: Anki

  - name: Kde Compose key
    remap:
      CapsLock-Apostrophe: CapsLock

  - name: Kill focused process (kills all instances of a browser, for example)
    remap:
      CapsLock-q: { launch: [wmctrl, -c, ':ACTIVE:'] }
      CapsLock-Shift-q: { launch: [xdotool, getwindowfocus, windowkill] }

  - name: Gromit
    remap:
      Super-f: { launch: [gromit-mpx, -t] }
      Super-Alt-f: { launch: [gromit-mpx, -c] }
      Super-g: { launch: [gromit-mpx, -t, -c] }

  - name: Edit clipboard
    remap:
      CapsLock-Dot:
        {
          launch:
            [
              sh,
              -c,
              "xclip -selection clipboard -o > /tmp/bibren ; kitty -T edit-clipboard nvim -n /tmp/bibren ; test -s /tmp/bibren && cat /tmp/bibren | xclip -r -selection clipboard",
            ],
        }
      CapsLock-Alt-Dot:
        {
          launch:
            [
              sh,
              -c,
              "truncate -s 0 /tmp/bibren ; kitty -T edit-clipboard nvim -n /tmp/bibren ; test -s /tmp/bibren && cat /tmp/bibren | xclip -r -selection clipboard",
            ],
        }

  - name: Pick unicode
    remap:
      CapsLock-m:
        {
          launch:
            [
              sh,
              -c,
              'kitty -T emoji-picker --start-as maximized sh -c "kitty +kitten unicode_input --tab code > /tmp/unicode_input" ; cat /tmp/unicode_input | xclip -r -selection clipboard',
            ],
        }

  - name: Float image in clipboard
    remap:
      Super-w:
        {
          launch:
            [
              fish,
              -c,
              "xclip -selection clipboard -t image/png -o 2>/dev/null | display",
            ],
        }

  - name: Put three random words to clipboard
    remap:
      Super-5:
        { launch: [sh, -c, "uclanr -tj '' 3 | xclip -r -selection clipboard"] }

  - name: Stdin typer
    remap:
      CapsLock-Comma: { launch: [sh, -c, "kitty --detach --hold -T infoterm holup"] }

  - name: Kitty
    remap:
      CapsLock-Slash: { launch: [kitty] }
      CapsLock-Alt-Slash: { launch: [kitty, -T, temporary-terminal] }

  - name: Screenkey
    remap:
      Super-3: { launch: [screenkey] }
      Super-Alt-3: { launch: [killall, screenkey] }

  - name: System
    remap:
      Sysrq: { launch: [sh, -c, "qdbus org.kde.ksmserver /KSMServer logout 0 0 0"]} # Printscreen
      Shift-Sysrq: { launch: [sh, -c, "clorange reboots increment ; poweroff"] }
      ScrollLock: { launch: [sh, -c, "clorange reboots increment ; reboot"] }
      Pause: { launch: [systemctl, suspend] }
      Shift-Pause: { launch: [xset, dpms, force, 'off'] }

      CapsLock-Alt-6: { launch: [sh, -c, "qdbus org.kde.ksmserver /KSMServer logout 0 0 0"]}
      CapsLock-Shift-Alt-6: { launch: [sh, -c, "clorange reboots increment ; poweroff"] }
      CapsLock-Shift-Alt-8: { launch: [sh, -c, "clorange reboots increment ; reboot"] }
      CapsLock-Alt-8: { launch: [kitty, -T, uboot, fish, -c, uboot] }
      CapsLock-Alt-7: { launch: [systemctl, suspend] }
      CapsLock-Alt-9: { launch: [xset, dpms, force, 'off'] }

  - name: System & Media
    remap:
      CapsLock-Alt-s: { launch: [qdbus, org.kde.kglobalaccel, /component/kmix, invokeShortcut, decrease_volume] }
      CapsLock-Alt-d: { launch: [qdbus, org.kde.kglobalaccel, /component/kmix, invokeShortcut, increase_volume] }
      CapsLock-Shift-s: { launch: [qdbus, org.kde.kglobalaccel, /component/mediacontrol, invokeShortcut, mediavolumedown] }
      CapsLock-Shift-d: { launch: [qdbus, org.kde.kglobalaccel, /component/mediacontrol, invokeShortcut, mediavolumeup] }
      CapsLock-Alt-w: { launch: [qdbus, org.kde.kglobalaccel, /component/mediacontrol, invokeShortcut, previousmedia] }
      CapsLock-Alt-e: { launch: [qdbus, org.kde.kglobalaccel, /component/mediacontrol, invokeShortcut, nextmedia] }
      CapsLock-Shift-w: { launch: [qdbus, org.kde.kglobalaccel, /component/kmix, invokeShortcut, decrease_microphone_volume] }
      CapsLock-Shift-e: { launch: [qdbus, org.kde.kglobalaccel, /component/kmix, invokeShortcut, increase_microphone_volume] }
      CapsLock-Alt-r: { launch: [qdbus, org.kde.kglobalaccel, /component/kmix, invokeShortcut, mic_mute] }
      CapsLock-Shift-r: { launch: [qdbus, org.kde.kglobalaccel, /component/kmix, invokeShortcut, mute] }
      CapsLock-Alt-f: { launch: [qdbus, org.kde.kglobalaccel, /component/mediacontrol, invokeShortcut, playpausemedia] }

      CapsLock-Alt-LeftBrace: { launch: [qdbus, org.kde.kglobalaccel, /component/org_kde_powerdevil, invokeShortcut, "Decrease Screen Brightness"] }
      CapsLock-Alt-RightBrace: { launch: [qdbus, org.kde.kglobalaccel, /component/org_kde_powerdevil, invokeShortcut, "Increase Screen Brightness"] }
      CapsLock-LeftBrace: { launch: [qdbus, org.kde.kglobalaccel, /component/kwin, invokeShortcut, "Decrease Opacity"] }
      CapsLock-RightBrace: { launch: [qdbus, org.kde.kglobalaccel, /component/kwin, invokeShortcut, "Increase Opacity"] }

  - remap:
      CapsLock-t: tab
      CapsLock-Backspace: delete
      CapsLock-a: delete

      CapsLock-h: left
      CapsLock-j: down
      CapsLock-k: up
      CapsLock-l: right
      CapsLock-i: home
      CapsLock-o: end
      CapsLock-u: pageup
      CapsLock-p: pagedown

      CapsLock-s: ctrl-c
      CapsLock-w: ctrl-x
      CapsLock-d: ctrl-v
      CapsLock-f: ctrl-a