[mgr]
keymap = [
  # [[sort on]]
  { on = '!', run = 'unyank', desc = 'Cancel the yank status' },
  { on = '%', run = 'toggle_all --state=true', desc = 'Select all' },
  { on = ',', run = 'escape --select', desc = 'Deselect all files' },
  { on = '.', run = 'hidden toggle', desc = 'Toggle the visibility of hidden files' },
  { on = '/', run = 'find --smart', desc = 'Find next file' },
  { on = '1', run = 'tab_switch 0', desc = 'Switch to tab 1' },
  { on = '2', run = 'tab_switch 1', desc = 'Switch to tab 2' },
  { on = '3', run = 'tab_switch 2', desc = 'Switch to tab 3' },
  { on = '4', run = 'tab_switch 3', desc = 'Switch to tab 4' },
  { on = '5', run = 'tab_switch 4', desc = 'Switch to tab 5' },
  { on = '6', run = 'tab_switch 5', desc = 'Switch to tab 6' },
  { on = '7', run = 'tab_switch 6', desc = 'Switch to tab 7' },
  { on = '8', run = 'tab_switch 7', desc = 'Switch to tab 8' },
  { on = '9', run = 'tab_switch 8', desc = 'Switch to tab 9' },
  { on = ':', run = 'quit', desc = 'Exit the process' },
  { on = ';', run = [ 'plugin blammo', 'plugin intellishell' ], desc = 'Run a shell command' },
  { on = '<', run = 'tab_switch -1 --relative', desc = 'Switch to the previous tab' },
  { on = '<C-c>', run = 'yank', desc = 'Yank selected files (copy)' },
  { on = '<C-h>', run = 'help', desc = 'Help' },
  { on = '<C-i>', run = 'plugin zoxide', desc = 'Jump to a directory using zoxide' },
  { on = '<C-r>', run = 'toggle_all', desc = 'Inverse selection of all files' },
  { on = '<C-x>', run = 'yank --cut', desc = 'Yank selected files (cut)' },
  { on = '<C-z>', run = [ 'plugin blammo', 'plugin storecwd' ], desc = 'Suspend the process' },
  { on = '<Down>', run = 'arrow 1', desc = 'Move cursor down' },
  { on = '<Enter>', run = 'open', desc = 'Open selected files' },
  { on = '<Esc>', run = 'escape --find --filter --search', desc = 'Cancel most things' },
  { on = '<PageDown>', run = 'arrow 50%', desc = 'Scroll down by half a page' },
  { on = '<PageUp>', run = 'arrow -50%', desc = 'Scroll up by half a page' },
  { on = '<S-PageDown>', run = 'seek 5', desc = 'Scroll preview down' },
  { on = '<S-PageUp>', run = 'seek -5', desc = 'Scroll preview up' },
  { on = '<Space>', run = 'select_all --state=false', desc = 'Deselect all' },
  { on = '<Tab>', run = 'spot', desc = 'Spot' },
  { on = '<Up>', run = 'arrow -1', desc = 'Move cursor up' },
  { on = '>', run = 'tab_switch 1 --relative', desc = 'Switch to the next tab' },
  { on = '?', run = 'find --previous --smart', desc = 'Find previous file' },
  { on = 'B', run = 'create --force --dir', desc = 'Create a directory' },
  { on = 'C', run = 'shell --confirm --block -- lazygit', desc = 'Open lazygit here' },
  { on = 'D', run = 'remove --permanently --force', desc = 'Delete selected' },
  { on = 'H', run = 'back', desc = 'Go back to the previous directory' },
  { on = 'I', run = 'plugin toggle-pane min-preview', desc = 'Toggle preview' },
  { on = 'L', run = 'forward', desc = 'Go forward to the next directory' },
  { on = 'N', run = 'find_arrow --previous', desc = 'Go to the previous found' },
  { on = 'O', run = 'paste --force', desc = 'Paste yanked files (overwrite if the destination exists)' },
  { on = 'S', run = [ 'plugin blammo', 'shell --confirm --orphan -- footclient' ], desc = 'Launch terminal here' },
  { on = 'T', run = 'close', desc = 'Close the current tab, or quit if it is last tab' },
  { on = 'a', run = 'plugin toggle_select', desc = 'Toggle select mode' },
  { on = 'b', run = 'create --force', desc = 'Create a blob' },
  { on = 'c', run = 'search fd', desc = 'Search files by name using fd' },
  { on = 'd', run = 'remove --force', desc = 'Trash selected' },
  { on = 'e', run = 'open --interactive', desc = 'Choose how to open' },
  { on = 'f', run = 'plugin jump-to-char', desc = 'Jump to char' },
  { on = 'h', run = 'leave', desc = 'Go back to the parent directory' },
  { on = 'i', run = 'plugin fzf', desc = 'Jump to a directory or reveal a file using fzf' },
  { on = 'j', run = 'arrow 1', desc = 'Move cursor down' },
  { on = 'k', run = 'arrow -1', desc = 'Move cursor up' },
  { on = 'l', run = 'enter', desc = 'Enter the child directory' },
  { on = 'n', run = 'find_arrow', desc = 'Go to the next found' },
  { on = 'o', run = 'paste', desc = 'Paste yanked files' },
  { on = 'r', run = 'rename --cursor=before_ext', desc = 'Rename selected file(s)' },
  { on = 't', run = 'tab_create --current', desc = 'Create a new tab with CWD' },
  { on = 'u', run = 'tasks:show', desc = 'Show task manager' },
  { on = 'v', run = 'toggle', desc = 'Toggle select hovered file' },
  { on = 'w', run = 'plugin toggle_deselect', desc = 'Toggle deselect mode' },
  { on = 'x', run = 'filter --smart', desc = 'Filter' },
  { on = 'y', run = 'search rg', desc = 'Search files by content using ripgrep' },
  { on = '{', run = 'tab_swap -1', desc = 'Swap current tab with previous tab' },
  { on = '}', run = 'tab_swap 1', desc = 'Swap current tab with next tab' },
  { on = [ '<C-s>', '<C-a>' ], run = [ 'sort natural --reverse', 'linemode none' ], desc = 'Sort naturally (reverse)' },
  { on = [ '<C-s>', '<C-c>' ], run = [ 'sort btime --reverse --dir-first=no', 'linemode btime' ], desc = 'Sort by created time (reverse)' },
  { on = [ '<C-s>', '<C-e>' ], run = [ 'sort extension --reverse --dir-first=yes', 'linemode none' ], desc = 'Sort by extension (reverse)' },
  { on = [ '<C-s>', '<C-m>' ], run = [ 'sort mtime --reverse --dir-first=no', 'linemode mtime' ], desc = 'Sort by modified time (reverse)' },
  { on = [ '<C-s>', '<C-s>' ], run = [ 'sort size --reverse --dir-first=no', 'linemode size' ], desc = 'Sort by size (reverse)' },
  { on = [ '<C-s>', 'a' ], run = [ 'sort natural --reverse=no', 'linemode none' ], desc = 'Sort naturally' },
  { on = [ '<C-s>', 'c' ], run = [ 'sort btime --reverse=no --dir-first=no', 'linemode btime' ], desc = 'Sort by created time' },
  { on = [ '<C-s>', 'e' ], run = [ 'sort extension --reverse=no --dir-first=yes', 'linemode none' ], desc = 'Sort by extension' },
  { on = [ '<C-s>', 'm' ], run = [ 'sort mtime --reverse=no --dir-first=no', 'linemode mtime' ], desc = 'Sort by modified time' },
  { on = [ '<C-s>', 'r' ], run = [ 'sort random --reverse=no --dir-first=no', 'linemode none' ], desc = 'Sort randomly' },
  { on = [ '<C-s>', 's' ], run = [ 'sort size --reverse=no --dir-first=no', 'linemode size' ], desc = 'Sort by size' },
  { on = [ 'g', 'h' ], run = 'cd ~', desc = 'Go home' },
  { on = [ 'g', 'i' ], run = 'arrow top', desc = 'Go to top' },
  { on = [ 'g', 'o' ], run = 'arrow bot', desc = 'Go to bottom' },
  { on = [ 'g', 'q' ], run = 'shell --confirm -- ya emit cd "$(git rev-parse --show-toplevel)"', desc = 'Go to repo root' },
  { on = [ 'm', 'C' ], run = 'shell --confirm -- ouch decompress "$@"', desc = 'Decompress archive(s) with ouch' },
  { on = [ 'm', 'c' ], run = 'plugin compress', desc = 'Archive selected files' },
  { on = [ 'm', 'r' ], run = 'shell --confirm -- fish -c "randomize_file_names (blammo)"', desc = 'Randomize names of selected file(s)' },
  { on = [ 'm', 's' ], run = [ 'plugin blammo', 'shell --block --confirm -- fish -c "ffmpeg_convert_to_mp3 (blammo)"' ], desc = 'Convert to mp3' },
  { on = [ 'm', 'v' ], run = [ 'plugin blammo', 'shell --block --confirm -- fish -c "ffmpeg_convert_video (blammo)"' ], desc = 'Manipulate video' },
  { on = [ 'm', 'w' ], run = [ 'plugin blammo', 'shell --confirm -- fish -c "webify (blammo)"' ], desc = 'Convert to webp, if that ends up smaller' },
  { on = [ 's', 'F' ], run = 'link --force --relative', desc = 'Symlink relatively' },
  { on = [ 's', 'K' ], run = 'copy name_without_ext', desc = 'Copy the filename without extension' },
  { on = [ 's', 'f' ], run = 'link --force', desc = 'Symlink' },
  { on = [ 's', 'i' ], run = [ 'plugin blammo', 'shell --confirm -- fish -c "copyl (blammo)"' ], desc = 'Copy uri list to clipboard' },
  { on = [ 's', 'j' ], run = 'copy path', desc = 'Copy the file path' },
  { on = [ 's', 'k' ], run = 'copy filename', desc = 'Copy the filename' },
  { on = [ 's', 'l' ], run = 'copy dirname', desc = 'Copy the directory path' },
  { on = [ 's', 'r' ], run = 'hardlink --force --follow', desc = 'Hardlink' },
  { on = [ 'z', ';' ], run = 'linemode none', desc = 'No linemode' },
  { on = [ 'z', 'i' ], run = 'linemode size', desc = 'Linemode: size' },
  { on = [ 'z', 'k' ], run = 'linemode permissions', desc = 'Linemode: permissions' },
  { on = [ 'z', 'm' ], run = 'linemode mtime', desc = 'Linemode: modified time' },
  { on = [ 'z', 'n' ], run = 'linemode btime', desc = 'Linemode: birth time' },
  { on = [ 'z', 'o' ], run = 'linemode owner', desc = 'Linemode: owner' },
  { on = [ 'z', 'z' ], run = 'shell --confirm -- zoxide add .', desc = 'Initialize current directory in zoxide' },
  # [[sort off]]
]

[tasks]
keymap = [
  # [[sort on]]
  { on = '<C-h>', run = 'help', desc = 'Open help' },
  { on = '<Down>', run = 'arrow 1', desc = 'Next task' },
  { on = '<Enter>', run = 'inspect', desc = 'Inspect the task' },
  { on = '<Esc>', run = 'close', desc = 'Close task manager' },
  { on = '<PageDown>', run = 'arrow 50%', desc = 'Scroll down by half a page' },
  { on = '<PageUp>', run = 'arrow -50%', desc = 'Scroll up by half a page' },
  { on = '<Up>', run = 'arrow -1', desc = 'Previous task' },
  { on = 'd', run = 'cancel', desc = 'Cancel the task' },
  { on = 'j', run = 'arrow 1', desc = 'Next task' },
  { on = 'k', run = 'arrow -1', desc = 'Previous task' },
  { on = 'u', run = 'close', desc = 'Close task manager' },
  { on = [ 'g', 'i' ], run = 'arrow top', desc = 'First task' },
  { on = [ 'g', 'o' ], run = 'arrow bot', desc = 'Last task' },
  # [[sort off]]
]

[spot]
keymap = [
  # [[sort on]]
  { on = '<C-h>', run = 'help', desc = 'Open help' },
  { on = '<Down>', run = 'arrow 1', desc = 'Next line' },
  { on = '<Esc>', run = 'close', desc = 'Close the spot' },
  { on = '<Left>', run = 'swipe prev', desc = 'Swipe to previous file' },
  { on = '<Right>', run = 'swipe next', desc = 'Swipe to next file' },
  { on = '<Tab>', run = 'close', desc = 'Close the spot' },
  { on = '<Up>', run = 'arrow -1', desc = 'Previous line' },
  { on = 'h', run = 'swipe prev', desc = 'Swipe to previous file' },
  { on = 'j', run = 'arrow 1', desc = 'Next line' },
  { on = 'k', run = 'arrow -1', desc = 'Previous line' },
  { on = 'l', run = 'swipe next', desc = 'Swipe to next file' },
  { on = 's', run = 'copy cell', desc = 'Copy selected cell' },
  { on = [ 'g', 'i' ], run = 'arrow top', desc = 'First line' },
  { on = [ 'g', 'o' ], run = 'arrow bot', desc = 'Last line' },
  # [[sort off]]
]

[input]
keymap = [
  # [[sort on]]
  { on = '<Backspace>', run = 'backspace', desc = 'Delete the character before the cursor' },
  { on = '<C-Backspace>', run = 'kill backward', desc = 'Kill backwards to the start of the current word' },
  { on = '<C-Delete>', run = 'kill forward', desc = 'Kill forwards to the end of the current word' },
  { on = '<C-Left>', run = 'backward', desc = 'Move back to the start of the current or previous word' },
  { on = '<C-Right>', run = 'forward --end-of-word', desc = 'Move forward to the end of the current or next word' },
  { on = '<C-h>', run = 'help', desc = 'Open help' },
  { on = '<C-k>', run = 'kill eol', desc = 'Kill forwards to the EOL' },
  { on = '<C-u>', run = 'kill bol', desc = 'Kill backwards to the BOL' },
  { on = '<C-w>', run = 'kill backward', desc = 'Kill backwards to the start of the current word' },
  { on = '<Delete>', run = 'backspace --under', desc = 'Delete the character under the cursor' },
  { on = '<End>', run = 'move eol', desc = 'Move to the EOL' },
  { on = '<Enter>', run = 'close --submit', desc = 'Submit input' },
  { on = '<Esc>', run = 'close', desc = 'Back to normal mode, or cancel input' },
  { on = '<Home>', run = 'move bol', desc = 'Move to the BOL' },
  { on = '<Left>', run = 'move -1', desc = 'Move back a character' },
  { on = '<Right>', run = 'move 1', desc = 'Move forward a character' },
  # [[sort off]]
]

[confirm]
keymap = [
  # [[sort on]]
  # { on = 'j', run = 'arrow next', desc = 'Next line' },
  # { on = 'k', run = 'arrow prev', desc = 'Previous line' },
  { on = '<C-h>', run = 'help', desc = 'Open help' },
  { on = '<Down>', run = 'arrow next', desc = 'Next line' },
  { on = '<Enter>', run = 'close --submit', desc = 'Submit the confirm' },
  { on = '<Esc>', run = 'close', desc = 'Cancel the confirm' },
  { on = '<Up>', run = 'arrow prev', desc = 'Previous line' },
  { on = 'j', run = 'close --submit', desc = 'Submit the confirm' },
  { on = 'k', run = 'close', desc = 'Cancel the confirm' },
  # [[sort off]]
]

[help]
keymap = [
  # [[sort on]]
  { on = '<C-h>', run = 'close', desc = 'Hide the help' },
  { on = '<Down>', run = 'arrow 1', desc = 'Next line' },
  { on = '<Esc>', run = 'escape', desc = 'Clear the filter, or hide the help' },
  { on = '<PageDown>', run = 'arrow 50%', desc = 'Scroll down by half a page' },
  { on = '<PageUp>', run = 'arrow -50%', desc = 'Scroll up by half a page' },
  { on = '<Up>', run = 'arrow -1', desc = 'Previous line' },
  { on = 'j', run = 'arrow 1', desc = 'Next line' },
  { on = 'k', run = 'arrow -1', desc = 'Previous line' },
  { on = 'x', run = 'filter', desc = 'Filter help items' },
  { on = [ 'g', 'i' ], run = 'arrow top', desc = 'First line' },
  { on = [ 'g', 'o' ], run = 'arrow bot', desc = 'Last line' },
  # [[sort off]]
]
